# 8.1 서버의 네트워크 설정 및 확인

 ## 8.1.1 리눅스 서버 네트워크

  일반적으로 리눅스에서 설정 파일이 텍스트 형태이고 텍스트를 직접 수정해 시스템 구성을 변경합니다.

### 8.1.1.1 CentOS 의 네트워크 설정

  `/etc/sysconfig/network-scripts` 위치에 있습니다. 인터페이스에 대한 설정 파일이나 인터페이스 제어용 스크립트가 있습니다.

  리눅스에서 인터페이스 설정파일을 수정하면 네트워크 서비스를 재시작하거나 인터페이스를 재시작해야 합니다. 

- 네트워크 서비스 재시작 : `systemctl restart network.service`
- 특정 인터페이스 다운 : `ifdown ifcfg-eth0`
- 특정 인터페이스 업 : `ifdown ifcfg-eth0`

### 8.1.1.2 우분투의 네트워크 설정

`/etc/network/interfaces` 에 설정파일이 있습니다. CentOS 와는 다르게 우분투는 interfaces 설정 파일에 네트워크의 모든 인터페이스 설정이 들어갑니다. 우분투에서 네트워크 서비스를 시작/정지/재시작하기 위해서는 다음 명령어를 사용합니다.

- `/etc/init.d/networking start`
- `/etc/init.d/networking stop`
- `/etc/init.d/networking reload`
- `/etc/init.d/networking restart`
- `/etc/init.d/networking force-reload`

# 8.2 서버의 라우팅 테이블

  서버에서도 라우팅 테이블을 가지고 있는데, 따로 설정하지 않더라도 디폴트 라우팅 테이블이 등록됩니다. 하지만 아래와 같이 네트워크 어댑터를 두 개 이상 사용할 때 여러 가지 고려사항이 생길 수 있습니다.

![image-20240409094846947](images/8장_서버_네트워크_기본/image-20240409094846947.png)

  두 네트워크 어댑터에 모두 다폴트 게이트웨이 설정을 하면 정상적으로 통신이 되지 않습니다. 외부 공인망 네트워크와 통신해야 하는 프론트엔드 네트워크 쪽 어댑터만 디폴트 게이트웨이를 설정하고 백엔드를 연결하는 어댑터에는 별도로 적절한 라우팅 정보를 반드시 설정해주어야 합니다.

## 8.2.1 서버의 라우팅 테이블

  서버의 라우팅 테이블 항목은 보통 아래와 같은 항목을 갖습니다.

- 목적지(Destination)
- 서브넷(Genmask)
- 게이트웨이(Gateway)
- 인터페이스(Iface)
- 우선순위(Metric)

![image-20240409095851784](images/8장_서버_네트워크_기본/image-20240409095851784.png)

  목적지와 서브넷은 서버가 통신하려는 목적지 IP 주소에 맞는 라우팅을 선택하는 기준이 됩니다. 게이트웨이는 목적지로 가기 위해 선택하는 넥스트 홉입니다. 인터페이스는 서버의 네트워크 카드를 말하고, 라우팅에서 어떤 물리적인 경로로 패킷을 내보낼지 설정합니다. 마지막으로 우선순위는 동일한 라우팅 테이블이 두 개 이상 존재할 때 어떤 라우팅 테이블을 선택할지 정하는 값입니다. 값이 낮을수록 우선순위가 높아집니다.

# 8.3 네트워크 확인을 위한 명령어

## 8.3.1 ping(Packet InterNet Groper)

  ping 은 ip 네트워크를 통해 특정 목적지까지 네트워크가 잘 동작하고 있는지 확인하는 명령어입니다. 또한 라우팅 경로가 정상적으로 구성되어 있는지도 함께 체크할 수 있습니다. ICMP(Internet Control Message Protocol) 라는 인터넷 프로토콜을 사용합니다.

> ping [옵션] 목적지\_ip_주소

  ping 에서 사용되는 주요옵션은 아래와 같습니다. (linux 기준)

- -c count : ping 을 보내는 패킷을 몇 번 보내고 종료할 것인지 지정. 기본 설정은 강제 종료 시까지 지속
- -i interval : 패킷을 보내는 시간 간격. 기본 설정값은 1초. 슈퍼 유저의 경우 0.2 이하로 설정 가능
- -I interface : 패킷을 보낼 때 출발지 주소를 지정. 
- -s packetsize : 패킷 크기를 지정. 기본 설정값은 56바이트(8바이트 ICMP 헤더가 추가로 붙어 64바이트를 송신)

## 8.3.3 traceroute(리눅스) / tracert (윈도)

  traceroute 는 출발지부터 통신하거나 목적지까지의 네트워크 경로를 확인할 때 사용하는 네트워크 명령어입니다. ping 보다 더 상세한 중간 경로 정보를 얻는 데 사용됩니다. traceroute 는 IP 헤더의 TTL 필드를 이용해서 TTL 을 1 부터 증가시키면서 목적지에 도달할 때까지 패킷을 반복적으로 전송하면서 경로를 추적합니다. 